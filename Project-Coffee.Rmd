---
title: "Project"
author: "SeanJ- Volcaetus"
date: "4/3/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data  ##
From TidyTuesday
URL:https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-07-07


```{r }
coffee_ratings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-07/coffee_ratings.csv')

```
# Quick overview #

```{r}
summary(coffee_ratings)
```
>A few NA's.

>1 within quakers, and 230 in Altitude low/high/mean

> Check what is happening in the rest of the data set

# Count of NA's per coloumn#
```{r}
apply(X=is.na(coffee_ratings), MARGIN = 2, FUN = sum)
```
> I will be just removing some of the columns with many missing vlaues, for instance farm_name.

```{r}
library(tidyverse)
```

Removal of columns
```{r}
coffee = coffee_ratings%>%
  select(-farm_name,-lot_number,-mill,-ico_number,-altitude,
         -altitude_low_meters,-altitude_high_meters,-producer,-company,
         -expiration,-certification_address,-owner_1,-grading_date,
         -certification_contact,-unit_of_measurement)
apply(X=is.na(coffee), MARGIN = 2, FUN = sum)
#view(coffee)
```


```{r}
coffee = na.omit(coffee)
#view(coffee)
```

```{r}
coffee[grep("lbs",coffee$bag_weight),]
```

```{r}
coffee = separate(data = coffee, col = bag_weight, into = c("weight", "type"), sep = " ")
```

```{r}
coffee$weight = as.numeric(coffee$weight)
```


```{r}
for(i in 1:length(coffee)){
  if(coffee[i,8]=="kg"){
  coffee[i,7] = round(coffee[i,7] * 2.20462,0)
  coffee[i,8] = "lbs"
  }
}  
```

```{r}
coffee = coffee%>%
  select(-type)
```

```{r}
coffee = coffee%>%
    rename(avg_altitude=altitude_mean_meters)
```

```{r}
coffee$avg_altitude = round(coffee$avg_altitude * 3.28084,0)
```


```{r}
coffee$harvest_year = substr(coffee$harvest_year,1,4)
coffee$harvest_year = as.numeric(coffee$harvest_year)
```

```{r}
summary(coffee[,c(9,12:24,26,28)])
```

```{r}
library(ggplot2)
```

check for outliers in some of the fields

```{r}
defect1_plt = ggplot(coffee, aes(y=category_one_defects)) +
              geom_boxplot()
defect2_plt = ggplot(coffee, aes(y=category_two_defects)) +
              geom_boxplot()
alt_plt = ggplot(coffee, aes(y=avg_altitude)) +
              geom_boxplot()
defect1_plt
defect2_plt
alt_plt
```

There are some outliers, but not that many that would result in a concern at this time.

Pick out some of the information that is not necessary at this point in exploration
```{r}
c = coffee[,c(1:2,4,10:26,28)]
```

Condense the data
```{r}
c.v1 = c%>%pivot_longer(
  cols = !c(species, country_of_origin,variety,processing_method,color),
  names_to = "Variables",
  values_to = "Counts")
c.v1
```

Plot the data to see overall behavior 
```{r}
ggplot(c.v1,aes(x=species,y=Counts,color=color))+geom_boxplot()+facet_wrap(~Variables,scales = "free")
```
Filter out the items that have known outliers
```{r}
c.v2 = c.v1 %>%
  filter(Variables != 'avg_altitude' & Variables != 'category_one_defects'& Variables != 'category_two_defects')
```


```{r}
g2 = ggplot(c.v2,aes(x=species,y=Counts,color=color))+geom_boxplot()+facet_wrap(~Variables,scales = "free")
g2
```
How are the cup points distributed and where the weight it is at
```{r}
c.v2 %>%
  filter(Variables == 'total_cup_points')%>%
  ggplot(aes(x=species,y=Counts,color=color))+geom_boxplot()

c.v2 %>%
  filter(Variables == 'total_cup_points')%>%
  ggplot(aes(x=species,y=Counts,color=color))+geom_violin()
```
```{r warning=FALSE}
c.v2 %>%
  filter(Variables == 'total_cup_points')%>%
  ggplot(aes(x=processing_method,y=Counts,color=color))+geom_boxplot()+
    facet_wrap(~processing_method,scales = "free")

c.v2 %>%
  filter(Variables == 'total_cup_points')%>%
  ggplot(aes(x=processing_method,y=Counts,color=color))+geom_violin()+
    facet_wrap(~processing_method,scales = "free")
```

